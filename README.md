##SQL commands to create table in Supabase

CREATE TABLE user_credentials (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  -- We use the session_id as the link to the user for now
  session_id TEXT NOT NULL,
  provider TEXT NOT NULL,
  access_token TEXT NOT NULL,
  refresh_token TEXT, -- Can be null for providers that don't issue them
  expires_at TIMESTAMPTZ, -- Timestamp with timezone
  other_details JSONB, -- For storing extra info like LinkedIn URN
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  -- This ensures a user can only have one credential per provider
  UNIQUE (session_id, provider)
);
